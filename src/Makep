# Makefile for PORBMN, PORBLS and TRI programs
# Created June 16, 1992
# Edited March 17, 1994
# Edited 2004sep21
# 2008sep29 Hugh Kieffer Modify for 64-bit cpu
# 2012feb05 HK Add qtest and routines that it calls
# 2013jun20 HK Add qtev for version 2
#---------------------------------------------


HHKOS=Linux_ix86                 # target operating system
HHKLIB=/home/hkieffer/linux/lib  # top of libraries to use
# Set up some shell-level specific variables
SHELL=/bin/csh
#RM=/bin/rm -f  # needed for 'clean'

FC=g77 -pipe
FFLAGS= -O -fno-automatic -fno-second-underscore -fargument-alias  # -g -C -xld 
LD=gcc

SYSLIBS =  -lg2c -lc -lm

# Library directories that always are searched in
LIBDIRS=-L$(HHKLIB)

#  Special Kieffer library groups
HLIB=-lhk_fmath -lhk_fgeom -lhk_futil -lhk_fchar -lhk_fNumRec # -lhk_rad
CLIB=-lhk_cisis                 # -lhk_crest

OBJECTS1 = porbmn.o porbio.o porb.o porb1.o porbqq.o orbit.o eccanom.o \
          obliq.o oblip.o ephemr.o spcrev.o caldate.o porbel.o ymd2j2.o  #caldat.o,julday.o

OBJECTS2 = porbls.o porb.o orbit.o eccanom.o vector.o 

OBJECTS3 = tri.o tricpt.o tercpt.o vector.o

OBJQ = qtest.o porbsa.o ymd2j2.o ymd2jd.o porb1.o porb2.o porbel.o obliv.o julday.o  rotdia.o rotax.o rotvec.o cocosp.o vaddsp.o upcase.o

OBJ5 = qtev.o porbsa.o ymd2j2.o ymd2jd.o porbig.o porbit.o porbel.o obliv.o julday.o  orbit.o  upcase.o eccanom.o datime.o prtpcom.o b2b.o rotmsp.o cocosp.o vaddsp.o
# last 3 above are packages

OBJ6 = porbmn.o porbio.o ephemr.o ymd2j2.o porbig.o porbit.o porbel.o orbit.o spcrev.o caldate.o caldat.o julday.o b2b.o upcase.o eccanom.o datime.o prtpcom.o rotmsp.o cocosp.o vaddsp.o

#normal link
porbm1: $(OBJECTS1)  # version 1 pre jun 2013
	$(FC) $(LDFLAGS) $(LIBDIRS) -o $@ $(OBJECTS1) \
	$(HLIB) $(CLIB) $(SYSLIBS)

porbls: $(OBJECTS2)
	$(FC) $(LDFLAGS) $(LIBDIRS) -o $@ $(OBJECTS2) \
	$(HLIB) $(CLIB) $(SYSLIBS)

tri: $(OBJECTS3)
	$(FC) $(LDFLAGS) $(LIBDIRS) -o $@ $(OBJECTS3) \
	$(HLIB) $(CLIB) $(SYSLIBS)

qtest: $(OBJQ)     # -xl required for record length to be in words
	$(FC) $(LDFLAGS) $(LIBDIRS) -o $@ $(OBJQ) \
	$(SYSLIBS)

qtev: $(OBJ5)
	$(FC) $(LDFLAGS) $(LIBDIRS) -o $@ $(OBJ5) \
	$(SYSLIBS)

porbmn: $(OBJ6)
	$(FC) $(LDFLAGS) $(LIBDIRS) -o $@ $(OBJ6) \
	$(SYSLIBS)
#
# make routines for program dependencies
#  
b2b.o: b2b.f
caldat.o: caldat.f
caldate.o: caldate.f
cocosp.o: cocosp.f # coordinate conversion package
datime.o: datime.f
eccanom.o: eccanom.f 
ephemr.o: ephemr.f  porbcm.inc
jdate.o:  jdate.f  
julday.o:  julday.f  
oblip.o:  oblip.f  
obliq.o:  obliq.f   
obliv.o:  obliv.f  
orbit.o:  orbit.f  
porb.o:   porb.f   porbcm.inc
porb1.o:  porb1.f    porbcm.inc
porbel.o: porbel.f 
porbig.o: porbig.f   porbcm.inc
porbit.o: porbit.f   porbcm.inc
porbio.o: porbio.f   porbcm.inc
porbls.o: porbls.f   porbcm.inc
porbmn.o: porbmn.f   porbcm.inc
porbqq.o: porbqq.f   porbcm.inc
porbsa.o: porbsa.f
prtpcom.o: prtpcom.f  porbcm.inc
qtest.o:  qtest.f   porbcm.inc 
qtev.o:  qtev.f   porbcm.inc 
rotmsp.o: rotmsp.f  # rotation matrix package
rotdia.o: rotdia.f 
rotax.o: rotax.f 
rotvec.o: rotvec.f 
spcrev.o: spcrev.f 
tercpt.o: tercpt.f 
tri.o:    tri.f    
tricpt.o: tricpt.f 
upcase.o: upcase.f
vector.o: vector.f 
vaddsp.o: vaddsp.f # vector package	

ymd2jd.o: ymd2jd.f
ymd2j2.o: ymd2j2.f

#
# Make clean
#
clean:
	-unalias rm; rm -f *.o
realclean:
	-rm porb
	-rm *.o 
